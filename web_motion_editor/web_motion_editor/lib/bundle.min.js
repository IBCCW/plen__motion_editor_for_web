"use strict";function FacebookButtonDirective(){return{restrict:"E",controller:FacebookButtonController,controllerAs:"facebook_button",scope:{},templateUrl:"./angularjs/components/FacebookButton/view.html",replace:!0}}function GoogleplusButtonDirective(){return{restrict:"E",controller:GoogleplusButtonController,controllerAs:"googleplus_button",scope:{},templateUrl:"./angularjs/components/GoogleplusButton/view.html",replace:!0}}function InstallButtonDirective(){return{restrict:"E",controller:InstallButtonController,controllerAs:"install_button",scope:{},templateUrl:"./angularjs/components/InstallButton/view.html",replace:!0}}function NewButtonDirective(){return{restrict:"E",controller:NewButtonController,controllerAs:"new_button",scope:{},templateUrl:"./angularjs/components/NewButton/view.html",replace:!0}}function NextButtonDirective(){return{restrict:"E",controller:NextButtonController,controllerAs:"next_button",scope:{},templateUrl:"./angularjs/components/NextButton/view.html",replace:!0}}function OpenButtonDirective(){return{restrict:"E",controller:OpenButtonController,controllerAs:"open_button",scope:{},templateUrl:"./angularjs/components/OpenButton/view.html",replace:!0,link:function(n,t){$(t[0].children[1]).on("change",function(t){var i=new FileReader;i.onload=function(t){n.open_button.motion.loadJSON(t.target.result);n.$apply()};i.readAsText(t.target.files[0])})}}}function PlayButtonDirective(){return{restrict:"E",controller:PlayButtonController,controllerAs:"play_button",scope:{},templateUrl:"./angularjs/components/PlayButton/view.html",replace:!0}}function PreviousButtonDirective(){return{restrict:"E",controller:PreviousButtonController,controllerAs:"previous_button",scope:{},templateUrl:"./angularjs/components/PreviousButton/view.html",replace:!0}}function ResetButtonDirective(){return{restrict:"E",controller:ResetButtonController,controllerAs:"reset_button",scope:{},templateUrl:"./angularjs/components/ResetButton/view.html",replace:!0}}function SaveButtonDirective(){return{restrict:"E",controller:SaveButtonController,controllerAs:"save_button",scope:{},templateUrl:"./angularjs/components/SaveButton/view.html",replace:!0}}function StopButtonDirective(){return{restrict:"E",controller:StopButtonController,controllerAs:"stop_button",scope:{},templateUrl:"./angularjs/components/StopButton/view.html",replace:!0}}function SyncButtonDirective(){return{restrict:"E",controller:SyncButtonController,controllerAs:"sync_button",scope:{},templateUrl:"./angularjs/components/SyncButton/view.html",replace:!0}}function TwitterButtonDirective(){return{restrict:"E",controller:TwitterButtonController,controllerAs:"twitter_button",scope:{},templateUrl:"./angularjs/components/TwitterButton/view.html",replace:!0}}var app_name="PLEN2MotionEditorForWeb",FacebookButtonController,CodeModel,OutputDeviceModel,FrameModel,MotionModel,ImageStoreService,FrameFactory,FrameEditorController,FrameEditorDirective,GoogleplusButtonController,InstallButtonController,ThreeModel,ThreeFactory,ModelEditorController,ModelLoader,ModelEditorDirective,NewButtonController,NextButtonController,OpenButtonController,PlayButtonController,PreviousButtonController,ResetButtonController,SaveButtonController,ScrollableContainerDirective,StopButtonController,SyncButtonController,TwitterButtonController,AutoResizeDirective;angular.module(app_name,["ngAnimate","ui.sortable"]);FacebookButtonController=function(){function n(n){this.$window=n;this.href="http://www.facebook.com/share.php?u=http://plen.jp/developer/motion-editor/"}return n.prototype.click=function(){this.$window.open(encodeURI(this.href),"facebook_window","width=650, height=470, menubar=no, toolbar=no, location=no, scrollbars=yes, sizable=yes")},n.$inject=["$window"],n}();angular.module(app_name).directive("facebookButton",FacebookButtonDirective);CodeModel=function(){function n(n,t){this.func=n;this.argments=t}return n}();OutputDeviceModel=function(){function n(n,t){this.device=n;this.value=t}return n}();FrameModel=function(){function n(n,t,i,r){this.transition_time_ms=n;this.outputs=t;this.selected=i;this.image_uri=r}return Object.defineProperty(n.prototype,"transition_time_ms",{get:function(){return this._transition_time_ms},set:function(n){_.isString(n)&&(this._transition_time_ms=_.parseInt(n));_.isNumber(n)&&(this._transition_time_ms=n)},enumerable:!0,configurable:!0}),n.prototype.deepCopy=function(n){var t=this;this.transition_time_ms=n.transition_time_ms;this.selected=n.selected;this.image_uri=n.image_uri;this.outputs=[];_.each(n.outputs,function(n){t.outputs.push(new OutputDeviceModel(n.device,n.value))})},n}();MotionModel=function(){function n(n,t){this.$rootScope=n;this.frame_factory=t;this.slot=0;this.name="Test Motion";this.codes=[];this.frames=[];this.frames.push(this.frame_factory.getFrame())}return n.prototype.getSelectedFrameIndex=function(){return _.findIndex(this.frames,function(n){return n.selected})},n.prototype.removeFrame=function(t){this.frames.length!==n.MIN_FRAMES?(this.frames[t].selected===!0&&(t+1===this.frames.length?this.selectFrame(t-1):this.selectFrame(t+1)),this.frames.splice(t,1)):this.reset()},n.prototype.addFrame=function(t){var r,u,i;this.frames.length>=n.MAX_FRAMES||(r=_.find(this.frames,function(n){return n.selected}),u=_.findIndex(this.frames,function(n){return n.selected}),this.$rootScope.$broadcast("FrameSave",u),i=this.frame_factory.getFrame(!1),i.deepCopy(r),i.selected=!1,this.frames.splice(t,0,i),this.selectFrame(t,!1))},n.prototype.selectFrame=function(n,t){if(t===void 0&&(t=!0),t){var i=_.findIndex(this.frames,function(n){return n.selected});this.$rootScope.$broadcast("FrameSave",i)}_.each(this.frames,function(n){n.selected=!1});this.frames[n].selected=!0;this.$rootScope.$broadcast("FrameLoad",n)},n.prototype.selectNextFrame=function(){var n=_.findIndex(this.frames,function(n){return n.selected});n+1!==this.frames.length&&this.selectFrame(n+1)},n.prototype.selectPrevFrame=function(){var n=_.findIndex(this.frames,function(n){return n.selected});n!==0&&this.selectFrame(n-1)},n.prototype.reset=function(){this.frames=[this.frame_factory.getFrame()];this.$rootScope.$broadcast("FrameLoad",0)},n.prototype.loadJSON=function(n){var i=this,t;try{if(t=JSON.parse(n),_.isUndefined(t.slot)||!_.isNumber(t.slot))throw"Bad format!.";if(_.isUndefined(t.name)||!_.isString(t.name))throw"Bad format!.";if(_.isUndefined(t.codes)||!_.isArray(t.codes))throw"Bad format!.";if(_.each(t.codes,function(n){if(_.isUndefined(n.func)||!_.isString(n.func))throw"Bad format!.";if(_.isUndefined(n.argments)||!_.isArray(n.argments))throw"Bad format!.";else _.each(n.argments,function(n){if(!_.isString(n))throw"Bad format!.";})}),_.isUndefined(t.frames)||!_.isArray(t.frames))throw"Bad format!.";else _.each(t.frames,function(n){if(_.isUndefined(n.transition_time_ms)||!_.isNumber(n.transition_time_ms))throw"Bad format!.";if(_.isUndefined(n.outputs)||!_.isArray(n.outputs))throw"Bad format!.";else _.each(n.outputs,function(n){if(_.isUndefined(n.device)||!_.isString(n.device))throw"Bad format!.";if(_.isUndefined(n.value)||!_.isNumber(n.value))throw"Bad format!.";})});this.slot=t.slot;this.name=t.name;this.codes=[];_.each(t.codes,function(n){var t=[];_.each(n.argments,function(n){t.push(n)});i.codes.push(new CodeModel(n.func,t))});this.frames=[];_.each(t.frames,function(n){var t=[];_.each(n.outputs,function(n){t.push(new OutputDeviceModel(n.device,n.value))});i.frames.push(new FrameModel(n.transition_time_ms,t,!1,""))});this.selectFrame(0,!1)}catch(r){alert("不正なモーションファイルのため、読み込みに失敗しました。")}},n.prototype.saveJSON=function(){var n={slot:this.slot,name:this.name,codes:this.codes,frames:[]};return _.each(this.frames,function(t){var i={};i.transition_time_ms=t._transition_time_ms;i.outputs=t.outputs;_.each(i.outputs,function(n){n.value=Math.round(n.value)});n.frames.push(i)}),JSON.stringify(n,null,"\t")},n.MIN_FRAMES=1,n.MAX_FRAMES=20,n}();ImageStoreService=function(){function n(){this._image_canvas=angular.element("<canvas/>")[0];this._image_canvas.width=150;this._image_canvas.height=150;this._context=this._image_canvas.getContext("2d")}return n.prototype.set=function(n){var r,u,t,i;n.width>n.height?(u=0,t=n.height,i=n.height,r=(n.width-t)/2):(r=0,t=n.width,i=n.width,u=(n.height-i)/2);this._context.drawImage(n,r,u,t,i,0,0,150,150)},n.prototype.get=function(){return this._image_canvas.toDataURL()},n}();angular.module(app_name).service("ImageStoreService",ImageStoreService);FrameFactory=function(){function n(n){this.image_store_service=n}return n.prototype.getFrame=function(n){return n===void 0&&(n=!0),new FrameModel(100,[],n,this.image_store_service.get())},n.$inject=["ImageStoreService"],n}();angular.module(app_name).service("FrameFactory",FrameFactory);angular.module(app_name).service("SharedMotionService",["$rootScope","FrameFactory",MotionModel]);FrameEditorController=function(){function n(n,t,i,r,u){var f=this;this.$rootScope=t;this.$q=i;this.$interval=r;this.motion=u;this.disabled=!1;this.touch_disabled="ontouchend"in document;this.sortable_options={axis:"x",scroll:!1,revert:!0};this.outputs_backup=[];this.animation_diffs=[];this.load_next=!0;n.$on("ComponentDisabled",function(){f.disabled=!0});n.$on("ComponentEnabled",function(){f.disabled=!1});n.$on("AnimationPlay",function(){f.onAnimationPlay()});n.$on("AnimationPause",function(){});n.$on("AnimationStop",function(){f.onAnimationStop()});n.$on("AnimationNext",function(){f.onAnimationPlay(!1,!0)});n.$on("AnimationPrevious",function(){f.onAnimationPlay(!0,!0)})}return n.prototype.onAnimationPlay=function(t,i){var r=this,u,o,f,e,s;if(t===void 0&&(t=!1),i===void 0&&(i=!1),u=this.motion.getSelectedFrameIndex(),o=this.motion.frames[u],t?(f=u-1,e=u===0?null:this.motion.frames[f]):(f=u+1,e=u+1===this.motion.frames.length?null:this.motion.frames[f]),_.isNull(e)){this.$rootScope.$broadcast("ComponentEnabled");return}this.load_next=!i;s=Math.ceil(e.transition_time_ms/(1e3/n.FPS));this.outputs_backup=[];this.animation_diffs=[];_.each(o.outputs,function(n,t){r.outputs_backup.push(n.value);r.animation_diffs.push((e.outputs[t].value-n.value)/s)});this.animation_promise=this.$interval(function(){_.each(r.animation_diffs,function(n,t){o.outputs[t].value+=n});r.$rootScope.$broadcast("FrameLoad",u)},1e3/n.FPS,s).catch(function(){console.log("abort");r.load_next=!1}).finally(function(){if(_.each(o.outputs,function(n,t){n.value=r.outputs_backup[t]}),r.motion.selectFrame(f,!1),r.load_next)r.onAnimationPlay(t);else r.$rootScope.$broadcast("ComponentEnabled")})},n.prototype.onAnimationStop=function(){this.load_next=!1},n.prototype.onClick=function(n){var i,t;n.target.id==="frame_editor"&&(i=_.isUndefined(n.offsetX)?n.pageX-$(n.target).offset().left:n.offsetX,t=Math.floor(i/173),t>this.motion.frames.length?this.motion.addFrame(this.motion.frames.length):this.motion.addFrame(t))},n.$inject=["$scope","$rootScope","$q","$interval","SharedMotionService"],n.FPS=30,n}();FrameEditorDirective=function(){function n(){}return n.getDDO=function(){return{restrict:"E",controller:FrameEditorController,controllerAs:"frame_editor",scope:{},templateUrl:"./angularjs/components/FrameEditor/view.html"}},n}();angular.module(app_name).directive("frameEditor",[FrameEditorDirective.getDDO]);GoogleplusButtonController=function(){function n(n){this.$window=n;this.href="https://plus.google.com/share?url=http://plen.jp/developer/motion-editor/"}return n.prototype.click=function(){this.$window.open(encodeURI(this.href),"googleplus_window","width=650, height=450, menubar=no, toolbar=no, location=no, scrollbars=yes, sizable=yes")},n.$inject=["$window"],n}();angular.module(app_name).directive("googleplusButton",GoogleplusButtonDirective);InstallButtonController=function(){function n(n,t){var i=this;this.$window=n;this.disabled=!1;t.$on("ComponentDisabled",function(){i.disabled=!0});t.$on("ComponentEnabled",function(){i.disabled=!1})}return n.prototype.onClick=function(){this.$window.alert("現在未実装の機能です。")},n.$inject=["$window","$scope"],n}();angular.module(app_name).directive("installButton",InstallButtonDirective);ThreeModel=function(){function n(){this.home_quaternions=[];this.rotation_axes=[];this.not_axes=[]}return n.prototype.init=function(n,t){this.layout=t;var i=this.layout.width(),r=this.layout.height();this.scene=new THREE.Scene;this.camera=new THREE.PerspectiveCamera(75,i/r,.1,5e3);this.camera.up.set(0,1,0);this.camera.position.set(200,200,500);this.grid=new THREE.GridHelper(1e3,100);this.grid.position.set(0,0,0);this.grid.setColors(11721489,16777215);this.scene.add(this.grid);this.light=new THREE.SpotLight(13421772);this.light.position.set(1e3,1e3,1e3);this.scene.add(this.light);this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0});this.renderer.setSize(i,r);this.renderer.setClearColor(6732650);this.orbit_controls=new THREE.OrbitControls(this.camera,this.renderer.domElement);this.orbit_controls.zoomSpeed=.3;this.transform_controls=new THREE.TransformControls(this.camera,this.renderer.domElement);this.transform_controls.setSpace("local");this.transform_controls.setMode("rotate");this.scene.add(this.transform_controls);n.append(this.renderer.domElement);this.renderer.render(this.scene,this.camera)},n.prototype.reset=function(){var n=this;_.each(this.rotation_axes,function(t,i){t.quaternion.copy(n.home_quaternions[i])})},n.prototype.resize=function(){var n=this.layout.width(),t=this.layout.height();this.camera.aspect=n/t;this.camera.updateProjectionMatrix();this.renderer.setSize(n,t)},n.prototype.animate=function(){var n=this;this.refresh();requestAnimationFrame(function(){n.animate()})},n.prototype.refresh=function(){this.orbit_controls.update();this.transform_controls.update();this.renderer.render(this.scene,this.camera)},n.prototype.intersect=function(n,t){var r=this,i=this.renderer.domElement.getBoundingClientRect(),o=(n-i.left)/i.width,s=(t-i.top)/i.height,f=new THREE.Vector3(o*2-1,-(s*2)+1,.5),e,u;f.unproject(this.camera);e=new THREE.Raycaster(this.camera.getWorldPosition(),f.sub(this.camera.getWorldPosition()).normalize());u=e.intersectObjects(this.not_axes,!0);u[0]?(this.transform_controls.detach(),_.each(this.rotation_axes,function(n){if(n===u[0].object.parent)return r.transform_controls.attach(n),r.orbit_controls.enabled=!1,!1;r.orbit_controls.enabled=!0})):(this.transform_controls.detach(),this.orbit_controls.enabled=!0)},n}();ThreeFactory=function(){function n(){}return n.prototype.getThree=function(){return new ThreeModel},n}();angular.module(app_name).service("ThreeFactory",ThreeFactory);ModelEditorController=function(){function n(n,t,i,r,u){var f=this;this.model_loader=t;this.motion=r;this.image_store_service=u;this.disabled=!1;this.three_model=i.getThree();n.$on("ComponentDisabled",function(){f.disabled=!0});n.$on("ComponentEnabled",function(){f.disabled=!1});n.$on("ModelEditorUnfocused",function(){f.onModelEditorUnfocused()});n.$on("3DModelLoaded",function(){f.on3DModelLoaded()});n.$on("3DModelReset",function(){f.on3DModelReset()});n.$on("FrameSave",function(n,t){f.onFrameSave(t)});n.$on("FrameLoad",function(n,t){f.onFrameLoad(t)})}return n.prototype.onModelEditorUnfocused=function(){this.three_model.transform_controls.detach();this.three_model.orbit_controls.enabled=!0},n.prototype.on3DModelLoaded=function(){this.setImage();this.three_model.home_quaternions=this.model_loader.home_quaternions;this.three_model.rotation_axes=this.model_loader.rotation_axes;this.three_model.not_axes=this.model_loader.not_axes},n.prototype.on3DModelReset=function(){this.three_model.reset();this.setImage()},n.prototype.onFrameSave=function(n){var t=this;this.motion.frames[n].outputs=[];_.each(this.three_model.rotation_axes,function(i,r){var o=t.three_model.home_quaternions[r].clone(),s=i.quaternion.clone(),e=o.inverse().multiply(s),u=Math.atan2(e.y,e.w),f;Math.abs(u*2)>Math.PI?(f=2*Math.PI-Math.abs(u*2),u>0&&(f*=-1)):f=u*2;t.motion.frames[n].outputs.push(new OutputDeviceModel(i.name,f*1800/Math.PI))})},n.prototype.onFrameLoad=function(n){var t=this;_.isEmpty(this.motion.frames[n].outputs)?(this.three_model.reset(),this.setImage()):_.each(this.motion.frames[n].outputs,function(n,i){var f=n.value*Math.PI/1800,r=t.three_model.home_quaternions[i].clone(),u=new THREE.Quaternion;u.setFromAxisAngle(new THREE.Vector3(0,1,0),f);r.multiply(u);t.three_model.rotation_axes[i].quaternion.copy(r)});_.isEmpty(this.motion.frames[n].image_uri)&&this.setImage()},n.prototype.onClick=function(n){this.disabled||this.intersect(n);this.setImage()},n.prototype.setImage=function(){var n,t;this.three_model.refresh();n=this.three_model.renderer.domElement;this.image_store_service.set(n);t=_.find(this.motion.frames,function(n){return n.selected});t.image_uri=this.image_store_service.get()},n.prototype.intersect=function(n){if(n.type!=="click"){this.three_model.transform_controls.detach();this.three_model.orbit_controls.enabled=!0;return}this.three_model.intersect(n.clientX,n.clientY)},n.$inject=["$scope","ModelLoaderService","ThreeFactory","SharedMotionService","ImageStoreService"],n}();ModelLoader=function(){function n(n,t){this.$rootScope=n;this.$http=t;this.home_quaternions=[];this.rotation_axes=[];this.not_axes=[]}return n.prototype.addRotationAxis=function(n){var t=this;/roll/.test(n.name)?(this.rotation_axes.push(n),this.home_quaternions.push(n.quaternion.clone())):/pitch/.test(n.name)?(this.rotation_axes.push(n),this.home_quaternions.push(n.quaternion.clone())):/yaw/.test(n.name)?(this.rotation_axes.push(n),this.home_quaternions.push(n.quaternion.clone())):this.not_axes.push(n);n.children.length>0&&_.each(n.children,function(n){t.addRotationAxis(n)})},n.prototype.addObject=function(n){this.scene.add(n);this.addRotationAxis(n)},n.prototype.setScene=function(n){for(this.scene.uuid=n.uuid,this.scene.name=n.name;n.children.length>0;)this.addObject(n.children[0])},n.prototype.loadJSON=function(){var n=this;this.$http.get("./assets/etc/plen_model.min.json").success(function(t){var r=t,u,i;r.metadata.type.toLowerCase()==="object"&&(u=new THREE.ObjectLoader,i=u.parse(r),i instanceof THREE.Scene?n.setScene(i):n.addObject(i),n.$rootScope.$broadcast("3DModelLoaded"))}).error(function(){alert("3Dモデルの読み込みに失敗しました。")})},n}();angular.module(app_name).service("ModelLoaderService",["$rootScope","$http",ModelLoader]);ModelEditorDirective=function(){function n(){}return n.getDDO=function(t,i,r){return{restrict:"E",controller:ModelEditorController,controllerAs:"model_editor",replace:!0,templateUrl:"./angularjs/components/ModelEditor/view.html",link:{pre:function(u){u.model_editor.layout={width:function(){return i.innerWidth-n.width_offset},height:function(){return i.innerHeight-n.height_offset},resizeFook:function(){u.model_editor.three_model.resize()}};u.model_editor.three_model.init($("#canvas_wrapper"),u.model_editor.layout);u.model_editor.three_model.animate();$("body").on("click",function(n){n.target!==u.model_editor.three_model.renderer.domElement&&t.$broadcast("ModelEditorUnfocused")});$("#canvas_wrapper canvas").on("touchend",function(n){u.model_editor.onClick(n);u.$apply()});r.scene=u.model_editor.three_model.scene;r.loadJSON()}}}},n.width_offset=285,n.height_offset=226,n}();angular.module(app_name).directive("modelEditor",["$rootScope","$window","ModelLoaderService",ModelEditorDirective.getDDO]);NewButtonController=function(){function n(n,t,i,r){var u=this;this.$rootScope=n;this.$window=i;this.motion=r;this.disabled=!1;t.$on("ComponentDisabled",function(){u.disabled=!0});t.$on("ComponentEnabled",function(){u.disabled=!1})}return n.prototype.click=function(){var n=this.$window.confirm('本当に新規にモーションを作成しますか？\n\n現在の作業内容が破棄されます。\n保存がまだの場合は"キャンセル"をクリックしてください。');n===!0&&(this.motion.reset(),this.$rootScope.$broadcast("3DModelReset"))},n.$inject=["$rootScope","$scope","$window","SharedMotionService"],n}();angular.module(app_name).directive("newButton",NewButtonDirective);NextButtonController=function(){function n(n,t){var i=this;this.$rootScope=n;this.disabled=!1;t.$on("ComponentDisabled",function(){i.disabled=!0});t.$on("ComponentEnabled",function(){i.disabled=!1})}return n.prototype.onClick=function(){this.$rootScope.$broadcast("ComponentDisabled");this.$rootScope.$broadcast("AnimationNext")},n.$inject=["$rootScope","$scope"],n}();angular.module(app_name).directive("nextButton",NextButtonDirective);OpenButtonController=function(){function n(n,t){var i=this;this.motion=t;this.disabled=!1;n.$on("ComponentDisabled",function(){i.disabled=!0});n.$on("ComponentEnabled",function(){i.disabled=!1})}return n.$inject=["$scope","SharedMotionService"],n}();angular.module(app_name).directive("openButton",OpenButtonDirective);PlayButtonController=function(){function n(n,t,i){var r=this;this.$rootScope=t;this.motion_model=i;this.disabled=!1;n.$on("ComponentDisabled",function(){r.disabled=!0});n.$on("ComponentEnabled",function(){r.disabled=!1})}return n.prototype.onClick=function(){this.$rootScope.$broadcast("ComponentDisabled");this.$rootScope.$broadcast("FrameSave",this.motion_model.getSelectedFrameIndex());this.$rootScope.$broadcast("AnimationPlay")},n.$inject=["$scope","$rootScope","SharedMotionService"],n}();angular.module(app_name).directive("playButton",PlayButtonDirective);PreviousButtonController=function(){function n(n,t){var i=this;this.$rootScope=t;this.disabled=!1;n.$on("ComponentDisabled",function(){i.disabled=!0});n.$on("ComponentEnabled",function(){i.disabled=!1})}return n.prototype.onClick=function(){this.$rootScope.$broadcast("ComponentDisabled");this.$rootScope.$broadcast("AnimationPrevious")},n.$inject=["$scope","$rootScope"],n}();angular.module(app_name).directive("previousButton",PreviousButtonDirective);ResetButtonController=function(){function n(n,t){var i=this;this.$rootScope=t;this.disabled=!1;n.$on("ComponentDisabled",function(){i.disabled=!0});n.$on("ComponentEnabled",function(){i.disabled=!1})}return n.prototype.click=function(){this.$rootScope.$broadcast("3DModelReset")},n.$inject=["$scope","$rootScope"],n}();angular.module(app_name).directive("resetButton",ResetButtonDirective);SaveButtonController=function(){function n(n,t,i){var r=this;this.$element=t;this.motion=i;this.disabled=!1;n.$on("ComponentDisabled",function(){r.disabled=!0});n.$on("ComponentEnabled",function(){r.disabled=!1});t.on("touchstart",function(){r.onClick()})}return n.prototype.onClick=function(){this.disabled||this.setDownloadLink()},n.prototype.setDownloadLink=function(){var i=this,t=new Blob([this.motion.saveJSON()],{type:"text/plain"}),n;navigator.msSaveBlob?navigator.msSaveBlob(t,this.motion.name+".json"):(n=new FileReader,n.onload=function(){i.$element[0].href=n.result},n.readAsDataURL(t))},n.$inject=["$scope","$element","SharedMotionService"],n}();angular.module(app_name).directive("saveButton",SaveButtonDirective);ScrollableContainerDirective=function(){function n(){}return n.getDDO=function(t){return{restrict:"A",controller:function(){},controllerAs:"scrollable_container",template:"<div ng-transclude/>",transclude:!0,link:function(i){i.scrollable_container.layout={width:function(){return t.innerWidth-n.width_offset},height:function(){return 158},resizeFook:function(){}}}}},n.width_offset=240,n}();angular.module(app_name).directive("scrollableContainer",["$window",ScrollableContainerDirective.getDDO]);StopButtonController=function(){function n(n){this.$rootScope=n}return n.prototype.onClick=function(){this.$rootScope.$broadcast("AnimationStop")},n.$inject=["$rootScope"],n}();angular.module(app_name).directive("stopButton",StopButtonDirective);SyncButtonController=function(){function n(n,t){var i=this;this.$window=t;this.disabled=!1;n.$on("ComponentDisabled",function(){i.disabled=!0});n.$on("ComponentEnabled",function(){i.disabled=!1})}return n.prototype.click=function(){this.$window.alert("現在未実装の機能です。")},n.$inject=["$scope","$window"],n}();angular.module(app_name).directive("syncButton",SyncButtonDirective);TwitterButtonController=function(){function n(n){this.$window=n;this.href="http://twitter.com/share?text=あなた好みにPLENを動かそう！「PLEN - Motion Editor for Web.」は、誰でも簡単にPLENのモーションを作成できるwebアプリです。&url=http://plen.jp/developer/motion-editor/&hashtags=PLEN"}return n.prototype.click=function(){this.$window.open(encodeURI(this.href),"tweeter_window","width=650, height=470, menubar=no, toolbar=no, location=no, scrollbars=yes, sizable=yes")},n.$inject=["$window"],n}();angular.module(app_name).directive("twitterButton",TwitterButtonDirective);AutoResizeDirective=function(){function n(){}return n.getDDO=function(n,t){return{restrict:"A",scope:{layout:"&autoResizeLayout",onload:"&autoResizeOnload"},link:function(i,r){i.onload()===!0&&(r.width(i.layout().width()),r.height(i.layout().height()),i.layout().resizeFook(r));var u=!1;n.addEventListener("resize",function(){u!==!1&&t.cancel(u);u=t(function(){r.width(i.layout().width());r.height(i.layout().height());i.layout().resizeFook(r)},100,!1)})}}},n}();angular.module(app_name).directive("autoResize",["$window","$timeout",AutoResizeDirective.getDDO]);
//# sourceMappingURL=bundle.min.js.map
